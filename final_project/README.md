## README

To run this program, you need to install **Android studio** on your PC, and install **ROS** system on your virtual machine. Virtual machines (such as Vmware) need to be connected to the network in "bridge mode", so that they can be under the same internal LAN as the front end.



### Front-end operation

First, you need to modify the address where your backend server is running:

1. In "MainFragment", change `addr` to the IP address where your ROS system (that is, the virtual machine) is located. Please ensure that your PC can ping this address.
2. In "RecordDialogFragment", change `rosAddr` to the IP address where the ROS system is located, and change `ownPC` to the IP address of your local machine (or the address where you run the backend voice server)

Then, click the following icon to synchronize the project and download the dependencies required by the project:

![image-20220619143450226](C:\Users\12849\AppData\Roaming\Typora\typora-user-images\image-20220619143450226.png)

After the build is successful, click Run app. At this point you must have an Android emulator first, or you must use your phone to connect to the computer and enable developer mode to allow program debugging using USB.

If the startup is successful, you will see the following screen:

<img src="C:\Users\12849\AppData\Roaming\Typora\typora-user-images\image-20220619143648734.png" alt="image-20220619143648734" style="zoom:50%;" />

Since it also needs to connect to the web server on the virtual machine side, it takes a while before the car interface is displayed.



### Back-end operation

Please download dependencies first: `pip install -r requirements.txt`

Then run HCI_flask.py directly on your PC.



### ROS system operation

Development environment: Ubuntu 18.04 + ros (melodic version)

Development software: vscode

Development language: Python 2.8, c++, rospy, roscpp



1. First install the environment dependencies:

```
sudo apt install ros-melodic-desktop-full
sudo apt-get install ros-melodic-rtabmap-ros 
sudo apt-get install ros-melodic-rosbridge-suite 
sudo apt-get install ros-melodic-driver-base 
sudo apt-get install ros--melodic-gazebo-ros-control 
sudo apt-get install ros--melodic-effort-controllers 
sudo apt-get install ros--melodic-joint-state-controller 
sudo apt-get install ros-melodic-ackermann-msgs 
sudo apt-get install ros-melodic-global-planner 
sudo apt-get install ros-melodic-teb-local-planner
...
```

2. racecar feature package compilation

```
cd ~/racecar_ws
catkin_make
```

3. Set environment variables, program registration.

```
echo "source ~/racecar_ws/devel/setup.bash" >> ~/.bashrc
source ~/.bashrc
```

4. Start gazebo, run the car model, and open the web application

```

\# Open gazobo, enable map building, navigation, target detection and other functions 

roslaunch racecar_gazebo mango_auto.launch 

\# Start ros-flask, so that the program sent by the app can be accepted by ros

rosrun racecar_gazebo ros_web_socket.py 

\# Open rviz and observe the status of the car

roslaunch racecar_gazebo auto_run.launch 

\# Open the web terminal, so that you can get car information, map information, etc. by visiting a specific web page

roslaunch rvizweb rvizweb.launch 
```

5. Finally, the back-end webpage generated by RvizWeb is:

http://localhost:8001/rvizweb/www/index.html